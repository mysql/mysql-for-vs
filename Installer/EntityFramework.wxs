<?xml version="1.0"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <Fragment Id='EntityFramework'>    <DirectoryRef Id="VS14_DBGenDir">
      <Component Id="EF.T4.VS14" Guid="9B861D6E-9401-45FF-B749-8E6519269B73">
        <File Id="VS14.SSDLToMySQL6" Name="SSDLToMySQL6.tt" DiskId="1"
              Source="..\Source\MySql.VisualStudio\T4Templates\VS2015\SSDLToMySQL6.tt"/>
        <File Id="VS14.SSDLToMySQL8" Name="SSDLToMySQL8.tt" DiskId="1"
              Source="..\Source\MySql.VisualStudio\T4Templates\VS2015\SSDLToMySQL8.tt"/>
        <File Id="VS14.GenerateMySQL.Utility" Name="GenerateMySQL.Utility.ttinclude" DiskId="1"
              Source="..\Source\MySql.VisualStudio\T4Templates\VS2015\GenerateMySQL.Utility.ttinclude"/>
      </Component>
    </DirectoryRef>

    <DirectoryRef Id='VS14_PrivateAssemblies'>
      <Component Id="EF.PA14.v45" Guid="45F17AF0-0EF0-4343-824A-9F450EC93F54" DiskId="1">
        <File Id="MySql.EF.PA14.v45" Name="MySql.Data.EntityFramework.dll"
              Source="..\Dependencies\v4.5\Release\mysql.data.entityframework.dll" DiskId="1"/>
      </Component>
    </DirectoryRef>

    <!-- Visual Studio 2017 Community -->
    <DirectoryRef Id="VS15_DBGenDir">
      <Component Id="EF.T4.VS15" Guid="ED507732-B12D-4B8E-AE91-A231DBE153BE">
        <File Id="VS15.SSDLToMySQL6" Name="SSDLToMySQL6.tt" DiskId="1"
              Source="..\Source\MySql.VisualStudio\T4Templates\VS2017\SSDLToMySQL6.tt"/>
        <File Id="VS15.SSDLToMySQL8" Name="SSDLToMySQL8.tt" DiskId="1"
              Source="..\Source\MySql.VisualStudio\T4Templates\VS2017\SSDLToMySQL8.tt"/>
        <File Id="VS15.GenerateMySQL.Utility" Name="GenerateMySQL.Utility.ttinclude" DiskId="1"
              Source="..\Source\MySql.VisualStudio\T4Templates\VS2017\GenerateMySQL.Utility.ttinclude"/>
      </Component>
    </DirectoryRef>

    <DirectoryRef Id='VS15_PrivateAssemblies'>
      <Component Id="EF.PA15.v45" Guid="37C9ED8D-9FC1-4D5F-9E8E-9BE96BB7D8CA" DiskId="1">
        <File Id="MySql.EF.PA15.v45" Name="MySql.Data.EntityFramework.dll"
              Source="..\Dependencies\v4.5\Release\mysql.data.entityframework.dll" DiskId="1"/>
      </Component>
    </DirectoryRef>

    <!-- Visual Studio 2017 Enterprise -->
    <DirectoryRef Id="VS15_Ent_DBGenDir">
      <Component Id="EF.T4.VS15.ENT" Guid="E11D288F-5CF1-4D51-9756-FEC0833A454A">
        <File Id="VS15.Ent.SSDLToMySQL6" Name="SSDLToMySQL6.tt" DiskId="1"
              Source="..\Source\MySql.VisualStudio\T4Templates\VS2017\SSDLToMySQL6.tt"/>
        <File Id="VS15.Ent.SSDLToMySQL8" Name="SSDLToMySQL8.tt" DiskId="1"
              Source="..\Source\MySql.VisualStudio\T4Templates\VS2017\SSDLToMySQL8.tt"/>
        <File Id="VS15.Ent.GenerateMySQL.Utility" Name="GenerateMySQL.Utility.ttinclude" DiskId="1"
              Source="..\Source\MySql.VisualStudio\T4Templates\VS2017\GenerateMySQL.Utility.ttinclude"/>
      </Component>
    </DirectoryRef>

    <DirectoryRef Id='VS15_Ent_PrivateAssemblies'>
      <Component Id="EF.PA15.Ent.v45" Guid="6B72F215-73C3-439C-A8D1-DCEDAEDBC901" DiskId="1">
        <File Id="MySql.EF.PA15.Ent.v45" Name="MySql.Data.EntityFramework.dll"
              Source="..\Dependencies\v4.5\Release\mysql.data.entityframework.dll" DiskId="1"/>
      </Component>
    </DirectoryRef>

    <!-- Visual Studio 2017 Professional -->
    <DirectoryRef Id="VS15_Pro_DBGenDir">
      <Component Id="EF.T4.VS15.PRO" Guid="E73E9892-0FBC-4E85-9736-0DCCA0693074">
        <File Id="VS15.Pro.SSDLToMySQL6" Name="SSDLToMySQL6.tt" DiskId="1"
              Source="..\Source\MySql.VisualStudio\T4Templates\VS2017\SSDLToMySQL6.tt"/>
        <File Id="VS15.Pro.SSDLToMySQL8" Name="SSDLToMySQL8.tt" DiskId="1"
              Source="..\Source\MySql.VisualStudio\T4Templates\VS2017\SSDLToMySQL8.tt"/>
        <File Id="VS15.Pro.GenerateMySQL.Utility" Name="GenerateMySQL.Utility.ttinclude" DiskId="1"
              Source="..\Source\MySql.VisualStudio\T4Templates\VS2017\GenerateMySQL.Utility.ttinclude"/>
      </Component>
    </DirectoryRef>

    <DirectoryRef Id='VS15_Pro_PrivateAssemblies'>
      <Component Id="EF.PA15.Pro.v45" Guid="C35DA4C0-0F68-488C-B3E1-D9BA42DB410D" DiskId="1">
        <File Id="MySql.EF.PA15.Pro.v45" Name="MySql.Data.EntityFramework.dll"
              Source="..\Dependencies\v4.5\Release\mysql.data.entityframework.dll" DiskId="1"/>
      </Component>
    </DirectoryRef>

    <!-- Visual Studio 2019 Community -->
    <DirectoryRef Id="VS16_DBGenDir">
      <Component Id="EF.T4.VS16" Guid="8A955332-238C-4536-B2F1-D7C36DE97A29">
        <File Id="VS16.SSDLToMySQL6" Name="SSDLToMySQL6.tt" DiskId="1"
              Source="..\Source\MySql.VisualStudio\T4Templates\VS2019\SSDLToMySQL6.tt"/>
        <File Id="VS16.SSDLToMySQL8" Name="SSDLToMySQL8.tt" DiskId="1"
              Source="..\Source\MySql.VisualStudio\T4Templates\VS2019\SSDLToMySQL8.tt"/>
        <File Id="VS16.GenerateMySQL.Utility" Name="GenerateMySQL.Utility.ttinclude" DiskId="1"
              Source="..\Source\MySql.VisualStudio\T4Templates\VS2019\GenerateMySQL.Utility.ttinclude"/>
      </Component>
    </DirectoryRef>

	<DirectoryRef Id='VS16_PrivateAssemblies'>
      <Component Id="EF.PA16.v45" Guid="92859C95-8717-423C-8E63-39A7EA557F39" DiskId="1">
        <File Id="MySql.EF.PA16.v45" Name="MySql.Data.EntityFramework.dll"
              Source="..\Dependencies\v4.5\Release\mysql.data.entityframework.dll" DiskId="1"/>
      </Component>
    </DirectoryRef>

    <!-- Visual Studio 2019 Enterprise -->
    <DirectoryRef Id="VS16_Ent_DBGenDir">
      <Component Id="EF.T4.VS16.ENT" Guid="19B45D76-EC97-413E-9DB2-697100BB5572">
        <File Id="VS16.Ent.SSDLToMySQL6" Name="SSDLToMySQL6.tt" DiskId="1"
              Source="..\Source\MySql.VisualStudio\T4Templates\VS2019\SSDLToMySQL6.tt"/>
        <File Id="VS16.Ent.SSDLToMySQL8" Name="SSDLToMySQL8.tt" DiskId="1"
              Source="..\Source\MySql.VisualStudio\T4Templates\VS2019\SSDLToMySQL8.tt"/>
        <File Id="VS16.Ent.GenerateMySQL.Utility" Name="GenerateMySQL.Utility.ttinclude" DiskId="1"
              Source="..\Source\MySql.VisualStudio\T4Templates\VS2019\GenerateMySQL.Utility.ttinclude"/>
      </Component>
    </DirectoryRef>

    <DirectoryRef Id='VS16_Ent_PrivateAssemblies'>
      <Component Id="EF.PA16.Ent.v45" Guid="B3022D57-118F-449A-A865-9451AB576452" DiskId="1">
        <File Id="MySql.EF.PA16.Ent.v45" Name="MySql.Data.EntityFramework.dll"
              Source="..\Dependencies\v4.5\Release\mysql.data.entityframework.dll" DiskId="1"/>
      </Component>
    </DirectoryRef>

    <!-- Visual Studio 2019 Professional -->
    <DirectoryRef Id="VS16_Pro_DBGenDir">
      <Component Id="EF.T4.VS16.PRO" Guid="4AA27184-3A37-4D9C-A967-78C5F61CBE5D">
        <File Id="VS16.Pro.SSDLToMySQL6" Name="SSDLToMySQL6.tt" DiskId="1"
              Source="..\Source\MySql.VisualStudio\T4Templates\VS2019\SSDLToMySQL6.tt"/>
        <File Id="VS16.Pro.SSDLToMySQL8" Name="SSDLToMySQL8.tt" DiskId="1"
              Source="..\Source\MySql.VisualStudio\T4Templates\VS2019\SSDLToMySQL8.tt"/>
        <File Id="VS16.Pro.GenerateMySQL.Utility" Name="GenerateMySQL.Utility.ttinclude" DiskId="1"
              Source="..\Source\MySql.VisualStudio\T4Templates\VS2019\GenerateMySQL.Utility.ttinclude"/>
      </Component>
    </DirectoryRef>

    <DirectoryRef Id='VS16_Pro_PrivateAssemblies'>
      <Component Id="EF.PA16.Pro.v45" Guid="4510B9A3-9BA7-4694-AF3E-48735B4FD7F3" DiskId="1">
        <File Id="MySql.EF.PA16.Pro.v45" Name="MySql.Data.EntityFramework.dll"
              Source="..\Dependencies\v4.5\Release\mysql.data.entityframework.dll" DiskId="1"/>
      </Component>
    </DirectoryRef>

    <!--Removing files from Public Assemblies Folders-->
    <DirectoryRef Id='VS14_PrivateAssemblies'>
      <Component Id="Remove.EF.PA14.v45" Guid="29548C71-81EE-4585-858C-E5E84E3F0C31" DiskId="1">
        <RemoveFile Id="RemoveMySql.EF.PA14.v45" Name="MySql.Data.EntityFramework.dll" On="uninstall" />
        <Condition>(NOT UPGRADINGPRODUCTCODE) AND (REMOVE=ALL)</Condition>
      </Component>
    </DirectoryRef>

    <!-- Visual Studio 2017 Community -->
    <DirectoryRef Id='VS15_PrivateAssemblies'>
      <Component Id="Remove.EF.PA15.v45" Guid="86882299-9C2A-4E6C-8307-E4E7234ECC44" DiskId="1">
        <RemoveFile Id="RemoveMySql.EF.PA15.v45" Name="MySql.Data.EntityFramework.dll" On="uninstall" />
        <Condition>(NOT UPGRADINGPRODUCTCODE) AND (REMOVE=ALL)</Condition>
      </Component>
    </DirectoryRef>

    <!-- Visual Studio 2017 Enterprise -->
    <DirectoryRef Id='VS15_Ent_PrivateAssemblies'>
      <Component Id="Remove.EF.PA15.Ent.v45" Guid="0904B7B4-B30D-4F74-AE4E-86889CF63BEA" DiskId="1">
        <RemoveFile Id="RemoveMySql.EF.PA15.Ent.v45" Name="MySql.Data.EntityFramework.dll" On="uninstall" />
        <Condition>(NOT UPGRADINGPRODUCTCODE) AND (REMOVE=ALL)</Condition>
      </Component>
    </DirectoryRef>

    <!-- Visual Studio 2017 Professional -->
    <DirectoryRef Id='VS15_Pro_PrivateAssemblies'>
      <Component Id="Remove.EF.PA15.Pro.v45" Guid="19510125-8E8D-4CAD-B9C5-C0345E007D6C" DiskId="1">
        <RemoveFile Id="RemoveMySql.EF.PA15.Pro.v45" Name="MySql.Data.EntityFramework.dll" On="uninstall" />
        <Condition>(NOT UPGRADINGPRODUCTCODE) AND (REMOVE=ALL)</Condition>
      </Component>
    </DirectoryRef>

    <!-- Visual Studio 2019 Community -->
    <DirectoryRef Id='VS16_PrivateAssemblies'>
      <Component Id="Remove.EF.PA16.v45" Guid="B5A8AE59-537C-40A5-9B31-D71F8B558232" DiskId="1">
        <RemoveFile Id="RemoveMySql.EF.PA16.v45" Name="MySql.Data.EntityFramework.dll" On="uninstall" />
        <Condition>(NOT UPGRADINGPRODUCTCODE) AND (REMOVE=ALL)</Condition>
      </Component>
    </DirectoryRef>

    <!-- Visual Studio 2019 Enterprise -->
    <DirectoryRef Id='VS16_Ent_PrivateAssemblies'>
      <Component Id="Remove.EF.PA16.Ent.v45" Guid="542BC2AC-AAE2-4FFA-8B27-57AADD8F16A0" DiskId="1">
        <RemoveFile Id="RemoveMySql.EF.PA16.Ent.v45" Name="MySql.Data.EntityFramework.dll" On="uninstall" />
        <Condition>(NOT UPGRADINGPRODUCTCODE) AND (REMOVE=ALL)</Condition>
      </Component>
    </DirectoryRef>

    <!-- Visual Studio 2019 Professional -->
    <DirectoryRef Id='VS16_Pro_PrivateAssemblies'>
      <Component Id="Remove.EF.PA16.Pro.v45" Guid="8E551575-7615-4503-9705-488C6320225C" DiskId="1">
        <RemoveFile Id="RemoveMySql.EF.PA16.Pro.v45" Name="MySql.Data.EntityFramework.dll" On="uninstall" />
        <Condition>(NOT UPGRADINGPRODUCTCODE) AND (REMOVE=ALL)</Condition>
      </Component>
    </DirectoryRef>

    <Feature Id="EntityFramework2015" Level="1" Display="expand" Title="Entity Framework Support for VS 2015"
               Description="Support for the entity framework">
      <Condition Level='0'>NOT VS_2015_PATH</Condition>
      <ComponentRef Id="EF.T4.VS14" />
      <ComponentRef Id="EF.PA14.v45"/>
      <ComponentRef Id="Remove.EF.PA14.v45"/>
    </Feature>

    <Feature Id="EntityFramework2017" Level="1" Display="expand" Title="Entity Framework Support for VS 2017"
           Description="Support for the entity framework">
      <Condition Level='0'>NOT VS2017COMINSTALL AND NOT VS2017ENTINSTALL AND NOT VS2017PROINSTALL</Condition>
      <Feature Id='EntityFramework2017Community' Level='1' Title='Community Edition'>
        <Condition Level='0'>NOT VS2017COMINSTALL</Condition>
        <ComponentRef Id="EF.T4.VS15" />
        <ComponentRef Id="EF.PA15.v45"/>
        <ComponentRef Id="Remove.EF.PA15.v45"/>
      </Feature>
      <Feature Id='EntityFramework2017Enterprise' Level='1' Title='Enterprise Edition'>
        <Condition Level='0'>NOT VS2017ENTINSTALL</Condition>
        <ComponentRef Id="EF.T4.VS15.ENT" />
        <ComponentRef Id="EF.PA15.Ent.v45"/>
        <ComponentRef Id="Remove.EF.PA15.Ent.v45"/>
      </Feature>
      <Feature Id='EntityFramework2017Professional' Level='1' Title='Professional Edition'>
        <Condition Level='0'>NOT VS2017PROINSTALL</Condition>
        <ComponentRef Id="EF.T4.VS15.PRO" />
        <ComponentRef Id="EF.PA15.Pro.v45"/>
        <ComponentRef Id="Remove.EF.PA15.Pro.v45"/>
      </Feature>
    </Feature>

    <Feature Id="EntityFramework2019" Level="1" Display="expand" Title="Entity Framework Support for VS 2019"
           Description="Support for the entity framework">
      <Condition Level='0'>NOT VS2019COMINSTALL AND NOT VS2019ENTINSTALL AND NOT VS2019PROINSTALL</Condition>
      <Feature Id='EntityFramework2019Community' Level='1' Title='Community Edition'>
        <Condition Level='0'>NOT VS2019COMINSTALL</Condition>
        <ComponentRef Id="EF.T4.VS16" />
        <ComponentRef Id="EF.PA16.v45"/>
        <ComponentRef Id="Remove.EF.PA16.v45"/>
      </Feature>
      <Feature Id='EntityFramework2019Enterprise' Level='1' Title='Enterprise Edition'>
        <Condition Level='0'>NOT VS2019ENTINSTALL</Condition>
        <ComponentRef Id="EF.T4.VS16.ENT" />
        <ComponentRef Id="EF.PA16.Ent.v45"/>
        <ComponentRef Id="Remove.EF.PA16.Ent.v45"/>
      </Feature>
      <Feature Id='EntityFramework2019Professional' Level='1' Title='Professional Edition'>
        <Condition Level='0'>NOT VS2019PROINSTALL</Condition>
        <ComponentRef Id="EF.T4.VS16.PRO" />
        <ComponentRef Id="EF.PA16.Pro.v45"/>
        <ComponentRef Id="Remove.EF.PA16.Pro.v45"/>
      </Feature>
    </Feature>
  </Fragment>
</Wix>


