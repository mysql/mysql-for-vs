<?xml version="1.0"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <Fragment Id='VSFragment'>

    <!-- Visual Studio 2012 -->
    <DirectoryRef Id='VS11_ExtVersionDir'>
      <Component Id='VS2012_Extension' Guid='ECB3633C-4169-4074-A527-3FDA825DDB2F'>
        <File Id='MySQL.VisualStudio.2012' Name='MySQL.VisualStudio.dll' DiskId='1'
              Source='..\Source\MySql.VisualStudio\bin\11.0v4.5.2\release\MySQL.VisualStudio.dll'/>
        <File Id='MySql.Parser.2012' Name='MySql.Parser.dll' DiskId='1'
          Source='..\Source\MySql.VisualStudio\bin\11.0v4.5.2\release\MySql.Parser.dll'/>
        <File Id='Antlr3.Runtime.2012' Name='Antlr3.Runtime.dll' DiskId='1'
              Source='..\Source\MySql.Parser\bin\Release\Antlr3.Runtime.dll'/>
        <File Id='VsixManifest.2012' Name='extension.vsixmanifest' DiskId='1'
              Source='..\Source\MySql.VisualStudio\bin\15.0v4.6.1\release\extension.vsixmanifest'/>
        <File Id='VSPkgdef.2012' Name='MySql.VisualStudio.pkgdef' DiskId='1'
              Source='..\Source\MySql.VisualStudio\bin\11.0v4.5.2\release\MySql.VisualStudio.pkgdef'/>
        <File Id='MySql.Debugger.2012' Name='MySql.Debugger.dll' DiskId='1'
              Source='..\Source\MySql.Debugger\bin\release\MySql.Debugger.dll'/>
        <File Id='MySql.Debugger.VisualStudio.2012' Name='MySql.Debugger.VisualStudio.dll' DiskId='1'
              Source='..\Source\MySql.Debugger.VisualStudio\bin\11.0v4.5.2\release\MySql.Debugger.VisualStudio.dll'/>
        <File Id='MySql.Utility_2012' Name='MySql.Utility.dll' DiskId='1'
              Source='..\Dependencies\v4.0\release\MySQL.Utility.dll'/>
      </Component>
    </DirectoryRef>

    <DirectoryRef Id='VS11_TemplatesDir'>
      <Component Id='VS2012_Templates' Guid='260283FF-817E-408E-8D87-7A4BF99BA818'>
        <File Id='VS2012_ScriptTemplate' Name='MySQL Script.mysql' DiskId='1'
              Source='..\Source\MySql.VisualStudio\Templates\MySQL Script.mysql'/>
        <File Id='VS2012_ScriptTemplate.vsdir' Name='MySqlDataProviderPackage.vsdir' DiskId='1'
              Source='..\Source\MySql.VisualStudio\Templates\MySqlDataProviderPackage.vsdir'/>
      </Component>
    </DirectoryRef>

    <DirectoryRef Id='VS11_PrivateAssemblies'>
      <Component Id='VS2012_MD.Library' Guid='BA082C85-9D64-4B79-8910-C6C25655250E'>
        <File Id='VS2012_MySql.DataLib' Name='MySql.Data.dll' DiskId='1'
             Source='..\Dependencies\v4.0\Release\MySql.Data.dll'/>
      </Component>
      <Component Id='VS2012_Web.Library' Guid='BA082C85-9D64-4B79-8910-C6C25655251E'>
        <File Id='VS2012_MySql.Web.Lib' Name='MySql.Web.dll' DiskId='1'
             Source='..\Dependencies\v4.0\Release\MySql.Web.dll'/>
      </Component>
      <Component Id='VS2012_Ext_BouncyCastle.Library' Guid='C082DB93-71EC-45E5-AF29-704004544109'>
        <File Id='VS2012_BouncyCastle.Crypto.Lib' Name='BouncyCastle.Crypto.dll' DiskId='1'
             Source='..\Dependencies\v4.0\Release\BouncyCastle.Crypto.dll'/>
      </Component>
      <Component Id='VS2012_Ext_SshNet.Library' Guid='930193AC-FEF7-4A86-A6D1-FB0E4916A80F'>
        <File Id='VS2012_Renci.SshNet.Lib' Name='Renci.SshNet.dll' DiskId='1'
             Source='..\Dependencies\v4.0\Release\Renci.SshNet.dll'/>
      </Component>
    </DirectoryRef>

    <!--Item Templates-->
    <DirectoryRef Id='VS11_CSharpITMySQL'>
      <Component Id='VS2012_VSIT_DIR' Guid='53498d20-e60d-4b46-8c94-27fa2a4333ea'>
        <File Id='VS2012_VSCS_Winform_ItemTemplate' Name='CSharpWinform_ItemTemplate.zip' DiskId='1'
              Source='..\ItemTemplatesZipFolder\MySQL_WinForm.zip' />
        <File Id='VS2012_VSCS_Web_ItemTemplate' Name='CSharpWeb_ItemTemplate.zip' DiskId='1'
              Source='..\ItemTemplatesZipFolder\MySQL_Web.zip' />
      </Component>
    </DirectoryRef>

    <DirectoryRef Id='VS11_VBITMySQL'>
      <Component Id='VS2012_VB_VSIT_DIR' Guid='dfb29060-0564-4851-b771-b5873a92ec90'>
        <File Id='VS2012_VSVB_Winform_ItemTemplate' Name='VBWinform_ItemTemplate.zip' DiskId='1'
              Source='..\ItemTemplatesZipFolder\MySQL_VB_WinForm.zip' />
        <File Id='VS2012_VSVB_Web_ItemTemplate' Name='VBWeb_ItemTemplate.zip' DiskId='1'
              Source='..\ItemTemplatesZipFolder\MySQL_VB_Web.zip' />
      </Component>
    </DirectoryRef>

    <DirectoryRef Id='VS11_T4TemplatesCSharpDir'>
      <Component Id='VS2012_T4TemplatesCSharpDir' Guid='BA082C85-9D64-1079-8910-C6C2565525FF'>
        <File Id='VS2012_T4TemplateCSharpController' Name='CSharpControllerClass.tt' DiskId='1'
            Source='..\Source\MySql.VisualStudio\Wizards\Web\T4Templates\CSharp\CSharpControllerClass.tt' />
        <File Id='VS2012_T4TemplateCSharpIndex' Name='CSharpIndexFile.tt' DiskId='1'
           Source='..\Source\MySql.VisualStudio\Wizards\Web\T4Templates\CSharp\CSharpIndexFile.tt' />
      </Component>
    </DirectoryRef>

    <DirectoryRef Id='VS11_T4TemplatesVBDir' >
      <Component Id='VS2012_T4TemplatesVBDir' Guid='BA082C85-9D64-1079-8910-C6C2565525AA'>
        <File Id='VS2012_T4TemplateVBController' Name='VisualBasicControllerClass.tt' DiskId='1'
            Source='..\Source\MySql.VisualStudio\Wizards\Web\T4Templates\VisualBasic\VisualBasicControllerClass.tt' />
        <File Id='VS2012_T4TemplateVBIndex' Name='VisualBasicIndexFile.tt' DiskId='1'
           Source='..\Source\MySql.VisualStudio\Wizards\Web\T4Templates\VisualBasic\VisualBasicIndexFile.tt' />
      </Component>
    </DirectoryRef>

    <!-- Visual Studio 2013 -->
    <DirectoryRef Id='VS12_ExtVersionDir'>
      <Component Id='VS2013_Extension' Guid='AFD7D38E-D166-4256-B1A5-637E7B33134B'>
        <File Id='MySQL.VisualStudio.2013' Name='MySQL.VisualStudio.dll' DiskId='1'
              Source='..\Source\MySql.VisualStudio\bin\12.0v4.5.2\release\MySQL.VisualStudio.dll'/>
        <File Id='MySql.Parser.2013' Name='MySql.Parser.dll' DiskId='1'
          Source='..\Source\MySql.VisualStudio\bin\12.0v4.5.2\release\MySql.Parser.dll'/>
        <File Id='Antlr3.Runtime.2013' Name='Antlr3.Runtime.dll' DiskId='1'
              Source='..\Source\MySql.Parser\bin\Release\Antlr3.Runtime.dll'/>
        <File Id='VsixManifest.2013' Name='extension.vsixmanifest' DiskId='1'
              Source='..\Source\MySql.VisualStudio\bin\15.0v4.6.1\release\extension.vsixmanifest'/>
        <File Id='VSPkgdef.2013' Name='MySql.VisualStudio.pkgdef' DiskId='1'
              Source='..\Source\MySql.VisualStudio\bin\12.0v4.5.2\release\MySql.VisualStudio.pkgdef'/>
        <File Id='MySql.Debugger.2013' Name='MySql.Debugger.dll' DiskId='1'
              Source='..\Source\MySql.Debugger\bin\release\MySql.Debugger.dll'/>
        <File Id='MySql.Debugger.VisualStudio.2013' Name='MySql.Debugger.VisualStudio.dll' DiskId='1'
              Source='..\Source\MySql.Debugger.VisualStudio\bin\12.0v4.5.2\release\MySql.Debugger.VisualStudio.dll'/>
        <File Id='MySql.Utility_2013' Name='MySql.Utility.dll' DiskId='1'
              Source='..\Dependencies\v4.0\release\MySQL.Utility.dll'/>
      </Component>
    </DirectoryRef>

    <DirectoryRef Id='VS12_TemplatesDir'>
      <Component Id='VS2013_Templates' Guid='299BAC3E-82EB-4FC2-9ECA-4E1C0F50F34C'>
        <File Id='VS2013_ScriptTemplate' Name='MySQL Script.mysql' DiskId='1'
              Source='..\Source\MySql.VisualStudio\Templates\MySQL Script.mysql'/>
        <File Id='VS2013_ScriptTemplate.vsdir' Name='MySqlDataProviderPackage.vsdir' DiskId='1'
              Source='..\Source\MySql.VisualStudio\Templates\MySqlDataProviderPackage.vsdir'/>
      </Component>
    </DirectoryRef>

    <DirectoryRef Id='VS12_PrivateAssemblies'>
      <Component Id='VS2013_MD.Library' Guid='4D8A38C2-9750-4C35-B89D-FD7FA6789BAC'>
        <File Id='VS2013_MySql.DataLib' Name='MySql.Data.dll' DiskId='1'
             Source='..\Dependencies\v4.0\Release\MySql.Data.dll'/>
      </Component>
      <Component Id='VS2013_Web.Library' Guid='0707943C-D00B-4D81-8722-E10CB4F77558'>
        <File Id='VS2013_MySql.Web.Lib' Name='MySql.Web.dll' DiskId='1'
             Source='..\Dependencies\v4.0\Release\MySql.Web.dll'/>
      </Component>
      <Component Id='VS2013_Ext_BouncyCastle.Library' Guid='CA630733-A51C-4C19-A6A3-E4D98182272E'>
        <File Id='VS2013_BouncyCastle.Crypto.Lib' Name='BouncyCastle.Crypto.dll' DiskId='1'
             Source='..\Dependencies\v4.0\Release\BouncyCastle.Crypto.dll'/>
      </Component>
      <Component Id='VS2013_Ext_SshNet.Library' Guid='AE23CF85-E6CA-40C2-A70D-DC8BD76E9B26'>
        <File Id='VS2013_Renci.SshNet.Lib' Name='Renci.SshNet.dll' DiskId='1'
             Source='..\Dependencies\v4.0\Release\Renci.SshNet.dll'/>
      </Component>	 
    </DirectoryRef>

    <!--Item Templates-->
    <DirectoryRef Id='VS12_CSharpITMySQL'>
      <Component Id='VS2013_VSIT_DIR' Guid='7C09EF65-F8D0-4BE8-9F0A-030933EF1F05'>
        <File Id='VS2013_VSCS_Winform_ItemTemplate' Name='CSharpWinform_ItemTemplate.zip' DiskId='1'
              Source='..\ItemTemplatesZipFolder\MySQL_WinForm.zip' />
        <File Id='VS2013_VSCS_Web_ItemTemplate' Name='CSharpWeb_ItemTemplate.zip' DiskId='1'
              Source='..\ItemTemplatesZipFolder\MySQL_Web.zip' />
      </Component>
    </DirectoryRef>

    <DirectoryRef Id='VS12_VBITMySQL'>
      <Component Id='VS2013_VB_VSIT_DIR' Guid='a20f84dd-fe3a-4ab4-a0f9-bd346c660fbe'>
        <File Id='VS2013_VSVB_Winform_ItemTemplate' Name='VBWinform_ItemTemplate.zip' DiskId='1'
              Source='..\ItemTemplatesZipFolder\MySQL_VB_WinForm.zip' />
        <File Id='VS2013_VSVB_Web_ItemTemplate' Name='VBWeb_ItemTemplate.zip' DiskId='1'
              Source='..\ItemTemplatesZipFolder\MySQL_VB_Web.zip' />
      </Component>
    </DirectoryRef>

    <DirectoryRef Id='VS12_T4TemplatesCSharpDir'>
      <Component Id='VS2013_T4TemplatesCSharpDir' Guid='BA082C85-9D64-1079-8910-C6C2565525CC'>
        <File Id='VS2013_T4TemplateCSharpController' Name='CSharpControllerClass.tt' DiskId='1'
            Source='..\Source\MySql.VisualStudio\Wizards\Web\T4Templates\CSharp\CSharpControllerClass.tt' />
        <File Id='VS2013_T4TemplateCSharpIndex' Name='CSharpIndexFile.tt' DiskId='1'
           Source='..\Source\MySql.VisualStudio\Wizards\Web\T4Templates\CSharp\CSharpIndexFile.tt' />
      </Component>
    </DirectoryRef>

    <DirectoryRef Id='VS12_T4TemplatesVBDir' >
      <Component Id='VS2013_T4TemplatesVBDir' Guid='BA082C85-9D64-1079-8910-C6C2565525BB'>
        <File Id='VS2013_T4TemplateVBController' Name='VisualBasicControllerClass.tt' DiskId='1'
            Source='..\Source\MySql.VisualStudio\Wizards\Web\T4Templates\VisualBasic\VisualBasicControllerClass.tt' />
        <File Id='VS2013_T4TemplateVBIndex' Name='VisualBasicIndexFile.tt' DiskId='1'
           Source='..\Source\MySql.VisualStudio\Wizards\Web\T4Templates\VisualBasic\VisualBasicIndexFile.tt' />
      </Component>
    </DirectoryRef>

    <!-- Visual Studio 2015 -->
    <DirectoryRef Id='VS14_ExtVersionDir'>
      <Component Id='VS2015_Extension' Guid='D7EE5F2F-5F1D-48F0-B7E6-E6D731B599F0'>
        <File Id='MySQL.VisualStudio.2015' Name='MySQL.VisualStudio.dll' DiskId='1'
              Source='..\Source\MySql.VisualStudio\bin\14.0v4.6\release\MySQL.VisualStudio.dll'/>
        <File Id='MySql.Parser.2015' Name='MySql.Parser.dll' DiskId='1'
          Source='..\Source\MySql.VisualStudio\bin\14.0v4.6\release\MySql.Parser.dll'/>
        <File Id='Antlr3.Runtime.2015' Name='Antlr3.Runtime.dll' DiskId='1'
              Source='..\Source\MySql.Parser\bin\Release\Antlr3.Runtime.dll'/>
        <File Id='VsixManifest.2015' Name='extension.vsixmanifest' DiskId='1'
              Source='..\Source\MySql.VisualStudio\bin\14.0v4.6\release\extension.vsixmanifest'/>
        <File Id='VSPkgdef.2015' Name='MySql.VisualStudio.pkgdef' DiskId='1'
              Source='..\Source\MySql.VisualStudio\bin\14.0v4.6\release\MySql.VisualStudio.pkgdef'/>
        <File Id='MySql.Debugger.2015' Name='MySql.Debugger.dll' DiskId='1'
              Source='..\Source\MySql.Debugger\bin\release\MySql.Debugger.dll'/>
        <File Id='MySql.Debugger.VisualStudio.2015' Name='MySql.Debugger.VisualStudio.dll' DiskId='1'
              Source='..\Source\MySql.Debugger.VisualStudio\bin\14.0v4.6\release\MySql.Debugger.VisualStudio.dll'/>
        <File Id='MySql.Utility_2015' Name='MySql.Utility.dll' DiskId='1'
              Source='..\Dependencies\v4.0\release\MySQL.Utility.dll'/>
      </Component>
    </DirectoryRef>

    <DirectoryRef Id='VS14_TemplatesDir'>
      <Component Id='VS2015_Templates' Guid='A7EB6122-2F0F-4C60-BC52-F3C5050DE211'>
        <File Id='VS2015_ScriptTemplate' Name='MySQL Script.mysql' DiskId='1'
              Source='..\Source\MySql.VisualStudio\Templates\MySQL Script.mysql'/>
        <File Id='VS2015_ScriptTemplate.vsdir' Name='MySqlDataProviderPackage.vsdir' DiskId='1'
              Source='..\Source\MySql.VisualStudio\Templates\MySqlDataProviderPackage.vsdir'/>
      </Component>
    </DirectoryRef>

    <DirectoryRef Id='VS14_PrivateAssemblies'>
      <Component Id='VS2015_MD.Library' Guid='3E76F0B9-B63E-4EEB-A7D1-C6CA28DB0CD2'>
        <File Id='VS2014_MySql.DataLib' Name='MySql.Data.dll' DiskId='1'
             Source='..\Dependencies\v4.0\Release\MySql.Data.dll'/>
      </Component>
      <Component Id='VS2015_Web.Library' Guid='9CC2D22E-CB4D-4472-A957-998CB9307B63'>
        <File Id='VS2015_MySql.Web.Lib' Name='MySql.Web.dll' DiskId='1'
             Source='..\Dependencies\v4.0\Release\MySql.Web.dll'/>
      </Component>
      <Component Id='VS2015_Ext_BouncyCastle.Library' Guid='A0170186-72EA-464E-82A3-63C06116A470'>
        <File Id='VS2015_BouncyCastle.Crypto.Lib' Name='BouncyCastle.Crypto.dll' DiskId='1'
             Source='..\Dependencies\v4.0\Release\BouncyCastle.Crypto.dll'/>
      </Component>
      <Component Id='VS2015_Ext_SshNet.Library' Guid='D9390384-20B1-404B-BFD4-9EE20822FF7C'>
        <File Id='VS2015_Renci.SshNet.Lib' Name='Renci.SshNet.dll' DiskId='1'
             Source='..\Dependencies\v4.0\Release\Renci.SshNet.dll'/>
      </Component>
    </DirectoryRef>

    <!--Item Templates-->
    <DirectoryRef Id='VS14_CSharpITMySQL'>
      <Component Id='VS2015_VSIT_DIR' Guid='eaa4081e-fea6-4640-9481-f3b1c922ba3d'>
        <File Id='VS2015_VSCS_Winform_ItemTemplate' Name='CSharpWinform_ItemTemplate.zip' DiskId='1'
              Source='..\ItemTemplatesZipFolder\MySQL_WinForm.zip' />
        <File Id='VS2015_VSCS_Web_ItemTemplate' Name='CSharpWeb_ItemTemplate.zip' DiskId='1'
              Source='..\ItemTemplatesZipFolder\MySQL_Web.zip' />
      </Component>
    </DirectoryRef>

    <DirectoryRef Id='VS14_VBITMySQL'>
      <Component Id='VS2015_VB_VSIT_DIR' Guid='b0f00be9-2298-469f-b269-fd42263c2432'>
        <File Id='VS2015_VSVB_Winform_ItemTemplate' Name='VBWinform_ItemTemplate.zip' DiskId='1'
              Source='..\ItemTemplatesZipFolder\MySQL_VB_WinForm.zip' />
        <File Id='VS2015_VSVB_Web_ItemTemplate' Name='VBWeb_ItemTemplate.zip' DiskId='1'
              Source='..\ItemTemplatesZipFolder\MySQL_VB_Web.zip' />
      </Component>
    </DirectoryRef>

    <DirectoryRef Id='VS14_T4TemplatesCSharpDir'>
      <Component Id='VS2015_T4TemplatesCSharpDir' Guid='CD3EEFFD-230E-4387-92F5-1BCEF885D02B'>
        <File Id='VS2015_T4TemplateCSharpController' Name='CSharpControllerClass.tt' DiskId='1'
            Source='..\Source\MySql.VisualStudio\Wizards\Web\T4Templates\CSharp\CSharpControllerClass.tt' />
        <File Id='VS2015_T4TemplateCSharpIndex' Name='CSharpIndexFile.tt' DiskId='1'
           Source='..\Source\MySql.VisualStudio\Wizards\Web\T4Templates\CSharp\CSharpIndexFile.tt' />
      </Component>
    </DirectoryRef>

    <DirectoryRef Id='VS14_T4TemplatesVBDir' >
      <Component Id='VS2015_T4TemplatesVBDir' Guid='F8C1D443-164C-4821-9608-CD58C69232C9'>
        <File Id='VS2015_T4TemplateVBController' Name='VisualBasicControllerClass.tt' DiskId='1'
            Source='..\Source\MySql.VisualStudio\Wizards\Web\T4Templates\VisualBasic\VisualBasicControllerClass.tt' />
        <File Id='VS2015_T4TemplateVBIndex' Name='VisualBasicIndexFile.tt' DiskId='1'
           Source='..\Source\MySql.VisualStudio\Wizards\Web\T4Templates\VisualBasic\VisualBasicIndexFile.tt' />
      </Component>
    </DirectoryRef>

    <!-- Visual Studio 2017 Community -->
    <DirectoryRef Id='VS15_ExtVersionDir'>
      <Component Id='VS2017_Com_EVars' Guid='13BBCEA7-FA64-43A5-B479-5422A5A9F0F9'>
        <Environment Id="VS150COMCOMNTOOLS" Name="VS150COMCOMNTOOLS" Value="[VS15_ToolsFolder]" Permanent="no" Part="all" Action="set" System="yes" />
      </Component>
      <Component Id='VS2017_Extension' Guid='ECFAAC07-9C26-45B3-9C5B-C0A8189EC6BB'>
        <File Id='MySQL.VisualStudio.2017' Name='MySQL.VisualStudio.dll' DiskId='1'
              Source='..\Source\MySql.VisualStudio\bin\15.0v4.6.1\release\MySQL.VisualStudio.dll'/>
        <File Id='MySql.Parser.2017' Name='MySql.Parser.dll' DiskId='1'
          Source='..\Source\MySql.VisualStudio\bin\15.0v4.6.1\release\MySql.Parser.dll'/>
        <File Id='Antlr3.Runtime.2017' Name='Antlr3.Runtime.dll' DiskId='1'
              Source='..\Source\MySql.Parser\bin\Release\Antlr3.Runtime.dll'/>
        <File Id='VsixManifest.2017' Name='extension.vsixmanifest' DiskId='1'
              Source='..\Source\MySql.VisualStudio\bin\15.0v4.6.1\release\extension.vsixmanifest'/>
        <File Id='VSPkgdef.2017' Name='MySql.VisualStudio.pkgdef' DiskId='1'
              Source='..\Source\MySql.VisualStudio\bin\15.0v4.6.1\release\MySql.VisualStudio.pkgdef'/>
        <File Id='MySql.Debugger.2017' Name='MySql.Debugger.dll' DiskId='1'
              Source='..\Source\MySql.Debugger\bin\release\MySql.Debugger.dll'/>
        <File Id='MySql.Debugger.VisualStudio.2017' Name='MySql.Debugger.VisualStudio.dll' DiskId='1'
              Source='..\Source\MySql.Debugger.VisualStudio\bin\15.0v4.6.1\release\MySql.Debugger.VisualStudio.dll'/>
        <File Id='MySql.Utility_2017' Name='MySql.Utility.dll' DiskId='1'
              Source='..\Dependencies\v4.0\release\MySQL.Utility.dll'/>
      </Component>
    </DirectoryRef>

    <DirectoryRef Id='VS15_TemplatesDir'>
      <Component Id='VS2017_Templates' Guid='2E04F618-B2BE-4296-9C48-838DC569B31F'>
        <File Id='VS2017_MySqlScriptTemplate' Name='MySQL Script.mysql' DiskId='1'
              Source='..\Source\MySql.VisualStudio\Templates\MySQL Script.mysql'/>
        <File Id='VS2017_ScriptTemplate.vsdir' Name='MySqlDataProviderPackage.vsdir' DiskId='1'
              Source='..\Source\MySql.VisualStudio\Templates\MySqlDataProviderPackage.vsdir'/>
      </Component>
    </DirectoryRef>

    <DirectoryRef Id='VS15_PrivateAssemblies'>
      <Component Id='VS2017_MD.Library' Guid='C9B431D4-8A15-4491-B9BC-70766A5474AF'>
        <File Id='VS2017_MySql.DataLib' Name='MySql.Data.dll' DiskId='1'
             Source='..\Dependencies\v4.0\Release\MySql.Data.dll'/>
      </Component>
      <Component Id='VS2017_Web.Library' Guid='C63A0350-536C-4ED0-A28A-0E41CFA67C87'>
        <File Id='VS2017_MySql.Web.Lib' Name='MySql.Web.dll' DiskId='1'
             Source='..\Dependencies\v4.0\Release\MySql.Web.dll'/>
      </Component>
      <Component Id='VS2017_Ext_BouncyCastle.Library' Guid='063FBE9D-E27C-45A5-B1DA-FB6CCA649515'>
        <File Id='VS2017_BouncyCastle.Crypto.Lib' Name='BouncyCastle.Crypto.dll' DiskId='1'
             Source='..\Dependencies\v4.0\Release\BouncyCastle.Crypto.dll'/>
      </Component>
      <Component Id='VS2017_Ext_SshNet.Library' Guid='739C0CA4-8E9E-4917-8D3E-77B8C5445D85'>
        <File Id='VS2017_Renci.SshNet.Lib' Name='Renci.SshNet.dll' DiskId='1'
             Source='..\Dependencies\v4.0\Release\Renci.SshNet.dll'/>
      </Component>
    </DirectoryRef>

    <!--Item Templates-->
    <DirectoryRef Id='VS15_ItemTemplates'>
      <Component Id='VS2017_VSIT_ROOT_DIR' Guid='E02E804C-B8BA-47B2-8A3B-3F74ED102EB1'>
        <File Id='VS2017_VSCS_ItemTemplate' Name='MySQLforVisualStudio.Item.vstman' DiskId='1'
              Source='..\Installer\ItemTemplates\MySQLforVisualStudio.Item.vstman' />
      </Component>
    </DirectoryRef>

    <DirectoryRef Id='VS15_CSharpITMySQL'>
      <Component Id='VS2017_VSIT_DIR' Guid='579849BF-FEE7-450C-A740-22613C7FED20'>
        <File Id='VS2017_VSCS_Winform_ItemTemplate' Name='CSharpWinform_ItemTemplate.zip' DiskId='1'
              Source='..\ItemTemplatesZipFolder\MySQL_WinForm.zip' />
        <File Id='VS2017_VSCS_Web_ItemTemplate' Name='CSharpWeb_ItemTemplate.zip' DiskId='1'
              Source='..\ItemTemplatesZipFolder\MySQL_Web.zip' />
      </Component>
    </DirectoryRef>

    <DirectoryRef Id='VS15_VBITMySQL'>
      <Component Id='VS2017_VB_VSIT_DIR' Guid='052AAF4F-0F8A-4148-A475-64057080C57D'>
        <File Id='VS2017_VSVB_Winform_ItemTemplate' Name='VBWinform_ItemTemplate.zip' DiskId='1'
              Source='..\ItemTemplatesZipFolder\MySQL_VB_WinForm.zip' />
        <File Id='VS2017_VSVB_Web_ItemTemplate' Name='VBWeb_ItemTemplate.zip' DiskId='1'
              Source='..\ItemTemplatesZipFolder\MySQL_VB_Web.zip' />
      </Component>
    </DirectoryRef>

    <DirectoryRef Id='VS15_T4TemplatesCSharpDir'>
      <Component Id='VS2017_T4TemplatesCSharpDir' Guid='C93BF679-6462-4D40-A882-879C84C16E3C'>
        <File Id='VS2017_T4TemplateCSharpController' Name='CSharpControllerClass.tt' DiskId='1'
            Source='..\Source\MySql.VisualStudio\Wizards\Web\T4Templates\CSharp\CSharpControllerClass.tt' />
        <File Id='VS2017_T4TemplateCSharpIndex' Name='CSharpIndexFile.tt' DiskId='1'
           Source='..\Source\MySql.VisualStudio\Wizards\Web\T4Templates\CSharp\CSharpIndexFile.tt' />
      </Component>
    </DirectoryRef>

    <DirectoryRef Id='VS15_T4TemplatesVBDir' >
      <Component Id='VS2017_T4TemplatesVBDir' Guid='DBF6552C-1AF3-4DC0-98A5-475257934F4B'>
        <File Id='VS2017_T4TemplateVBController' Name='VisualBasicControllerClass.tt' DiskId='1'
            Source='..\Source\MySql.VisualStudio\Wizards\Web\T4Templates\VisualBasic\VisualBasicControllerClass.tt' />
        <File Id='VS2017_T4TemplateVBIndex' Name='VisualBasicIndexFile.tt' DiskId='1'
           Source='..\Source\MySql.VisualStudio\Wizards\Web\T4Templates\VisualBasic\VisualBasicIndexFile.tt' />
      </Component>
    </DirectoryRef>

    <!-- Visual Studio 2017 Enterprise -->
    <DirectoryRef Id='VS15_Ent_ExtVersionDir'>
      <Component Id='VS2017_Ent_EVars' Guid='428FC606-512E-47B3-AC49-8F8350BD7477'>
        <Environment Id="VS150ENTCOMNTOOLS" Name="VS150ENTCOMNTOOLS" Value="[VS15_Ent_ToolsFolder]" Permanent="no" Part="all" Action="set" System="yes" />
      </Component>
      <Component Id='VS2017_Ent_Extension' Guid='83742E8E-9C38-408B-8726-965D68A3203A'>
        <File Id='MySQL.VisualStudio.2017_Ent' Name='MySQL.VisualStudio.dll' DiskId='1'
              Source='..\Source\MySql.VisualStudio\bin\15.0v4.6.1\release\MySQL.VisualStudio.dll'/>
        <File Id='MySql.Parser.2017_Ent' Name='MySql.Parser.dll' DiskId='1'
          Source='..\Source\MySql.VisualStudio\bin\15.0v4.6.1\release\MySql.Parser.dll'/>
        <File Id='Antlr3.Runtime.2017_Ent' Name='Antlr3.Runtime.dll' DiskId='1'
              Source='..\Source\MySql.Parser\bin\Release\Antlr3.Runtime.dll'/>
        <File Id='VsixManifest.2017_Ent' Name='extension.vsixmanifest' DiskId='1'
              Source='..\Source\MySql.VisualStudio\bin\15.0v4.6.1\release\extension.vsixmanifest'/>
        <File Id='VSPkgdef.2017_Ent' Name='MySql.VisualStudio.pkgdef' DiskId='1'
              Source='..\Source\MySql.VisualStudio\bin\15.0v4.6.1\release\MySql.VisualStudio.pkgdef'/>
        <File Id='MySql.Debugger.2017_Ent' Name='MySql.Debugger.dll' DiskId='1'
              Source='..\Source\MySql.Debugger\bin\release\MySql.Debugger.dll'/>
        <File Id='MySql.Debugger.VisualStudio.2017_Ent' Name='MySql.Debugger.VisualStudio.dll' DiskId='1'
              Source='..\Source\MySql.Debugger.VisualStudio\bin\15.0v4.6.1\release\MySql.Debugger.VisualStudio.dll'/>
        <File Id='MySql.Utility_2017_Ent' Name='MySql.Utility.dll' DiskId='1'
              Source='..\Dependencies\v4.0\release\MySQL.Utility.dll'/>
      </Component>
    </DirectoryRef>

    <DirectoryRef Id='VS15_Ent_TemplatesDir'>
      <Component Id='VS2017_Ent_Templates' Guid='FC7E78AE-1477-4B2E-A344-E930850E24DF'>
        <File Id='VS2017_Ent_MySqlScriptTemplate' Name='MySQL Script.mysql' DiskId='1'
              Source='..\Source\MySql.VisualStudio\Templates\MySQL Script.mysql'/>
        <File Id='VS2017_Ent_ScriptTemplate.vsdir' Name='MySqlDataProviderPackage.vsdir' DiskId='1'
              Source='..\Source\MySql.VisualStudio\Templates\MySqlDataProviderPackage.vsdir'/>
      </Component>
    </DirectoryRef>

    <DirectoryRef Id='VS15_Ent_PrivateAssemblies'>
      <Component Id='VS2017_Ent_MD.Library' Guid='B2A955B4-7C1D-4A54-B57B-4F16F44AB7EE'>
        <File Id='VS2017_Ent_MySql.DataLib' Name='MySql.Data.dll' DiskId='1'
             Source='..\Dependencies\v4.0\Release\MySql.Data.dll'/>
      </Component>
      <Component Id='VS2017_Ent_Web.Library' Guid='39F2F0AA-A018-4FF3-9376-B128383E962E'>
        <File Id='VS2017_Ent_MySql.Web.Lib' Name='MySql.Web.dll' DiskId='1'
             Source='..\Dependencies\v4.0\Release\MySql.Web.dll'/>
      </Component>
      <Component Id='VS2017_Ent_Ext_BouncyCastle.Library' Guid='153BE379-E55E-4B87-A050-F0A61DB2EB35'>
        <File Id='VS2017_Ent_BouncyCastle.Crypto.Lib' Name='BouncyCastle.Crypto.dll' DiskId='1'
             Source='..\Dependencies\v4.0\Release\BouncyCastle.Crypto.dll'/>
      </Component>
      <Component Id='VS2017_Ent_Ext_SshNet.Library' Guid='C8F3B714-02EF-42C9-8EC8-31202A693440'>
        <File Id='VS2017_Ent_Renci.SshNet.Lib' Name='Renci.SshNet.dll' DiskId='1'
             Source='..\Dependencies\v4.0\Release\Renci.SshNet.dll'/>
      </Component>
    </DirectoryRef>

    <!--Item Templates-->
    <DirectoryRef Id='VS15_Ent_ItemTemplates'>
      <Component Id='VS2017_ENT_VSIT_ROOT_DIR' Guid='95B2E000-F7F8-41F4-A83E-0C83D22209F7'>
        <File Id='VS2017_Ent_VSCS_ItemTemplate' Name='MySQLforVisualStudio.Item.vstman' DiskId='1'
              Source='..\Installer\ItemTemplates\MySQLforVisualStudio.Item.vstman' />
      </Component>
    </DirectoryRef>

    <DirectoryRef Id='VS15_Ent_CSharpITMySQL'>
      <Component Id='VS2017_ENT_VSIT_DIR' Guid='8D1C3C66-DBCD-4F91-AFC0-BDBD349103E3'>
        <File Id='VS2017_Ent_VSCS_Winform_ItemTemplate' Name='CSharpWinform_ItemTemplate.zip' DiskId='1'
              Source='..\ItemTemplatesZipFolder\MySQL_WinForm.zip' />
        <File Id='VS2017_Ent_VSCS_Web_ItemTemplate' Name='CSharpWeb_ItemTemplate.zip' DiskId='1'
              Source='..\ItemTemplatesZipFolder\MySQL_Web.zip' />
      </Component>
    </DirectoryRef>

    <DirectoryRef Id='VS15_Ent_VBITMySQL'>
      <Component Id='VS2017_ENT_VB_VSIT_DIR' Guid='BDC3A9E4-C2B2-4337-A343-A97F09666431'>
        <File Id='VS2017_Ent_VSVB_Winform_ItemTemplate' Name='VBWinform_ItemTemplate.zip' DiskId='1'
              Source='..\ItemTemplatesZipFolder\MySQL_VB_WinForm.zip' />
        <File Id='VS2017_Ent_VSVB_Web_ItemTemplate' Name='VBWeb_ItemTemplate.zip' DiskId='1'
              Source='..\ItemTemplatesZipFolder\MySQL_VB_Web.zip' />
      </Component>
    </DirectoryRef>

    <DirectoryRef Id='VS15_Ent_T4TemplatesCSharpDir'>
      <Component Id='VS2017_Ent_T4TemplatesCSharpDir' Guid='B2C802CE-D2AB-4162-BC0F-6A95316B0161'>
        <File Id='VS2017_Ent_T4TemplateCSharpController' Name='CSharpControllerClass.tt' DiskId='1'
            Source='..\Source\MySql.VisualStudio\Wizards\Web\T4Templates\CSharp\CSharpControllerClass.tt' />
        <File Id='VS2017_Ent_T4TemplateCSharpIndex' Name='CSharpIndexFile.tt' DiskId='1'
           Source='..\Source\MySql.VisualStudio\Wizards\Web\T4Templates\CSharp\CSharpIndexFile.tt' />
      </Component>
    </DirectoryRef>

    <DirectoryRef Id='VS15_Ent_T4TemplatesVBDir' >
      <Component Id='VS2017_Ent_T4TemplatesVBDir' Guid='0246C16E-772E-4B8E-8CCB-AFFC24FA3651'>
        <File Id='VS2017_Ent_T4TemplateVBController' Name='VisualBasicControllerClass.tt' DiskId='1'
            Source='..\Source\MySql.VisualStudio\Wizards\Web\T4Templates\VisualBasic\VisualBasicControllerClass.tt' />
        <File Id='VS2017_Ent_T4TemplateVBIndex' Name='VisualBasicIndexFile.tt' DiskId='1'
           Source='..\Source\MySql.VisualStudio\Wizards\Web\T4Templates\VisualBasic\VisualBasicIndexFile.tt' />
      </Component>
    </DirectoryRef>

    <!-- Visual Studio 2017 Professional -->
    <DirectoryRef Id='VS15_Pro_ExtVersionDir'>
      <Component Id='VS2017_Pro_EVars' Guid='8620E2FF-41CA-4C56-A998-AF6461067BD6'>
        <Environment Id="VS150PROCOMNTOOLS" Name="VS150PROCOMNTOOLS" Value="[VS15_Pro_ToolsFolder]" Permanent="no" Part="all" Action="set" System="yes" />
      </Component>
      <Component Id='VS2017_Pro_Extension' Guid='B67DC31A-B86D-44E7-A606-12E7E8FEAFDD'>
        <File Id='MySQL.VisualStudio.2017_Pro' Name='MySQL.VisualStudio.dll' DiskId='1'
              Source='..\Source\MySql.VisualStudio\bin\15.0v4.6.1\release\MySQL.VisualStudio.dll'/>
        <File Id='MySql.Parser.2017_Pro' Name='MySql.Parser.dll' DiskId='1'
          Source='..\Source\MySql.VisualStudio\bin\15.0v4.6.1\release\MySql.Parser.dll'/>
        <File Id='Antlr3.Runtime.2017_Pro' Name='Antlr3.Runtime.dll' DiskId='1'
              Source='..\Source\MySql.Parser\bin\Release\Antlr3.Runtime.dll'/>
        <File Id='VsixManifest.2017_Pro' Name='extension.vsixmanifest' DiskId='1'
              Source='..\Source\MySql.VisualStudio\bin\15.0v4.6.1\release\extension.vsixmanifest'/>
        <File Id='VSPkgdef.2017_Pro' Name='MySql.VisualStudio.pkgdef' DiskId='1'
              Source='..\Source\MySql.VisualStudio\bin\15.0v4.6.1\release\MySql.VisualStudio.pkgdef'/>
        <File Id='MySql.Debugger.2017_Pro' Name='MySql.Debugger.dll' DiskId='1'
              Source='..\Source\MySql.Debugger\bin\release\MySql.Debugger.dll'/>
        <File Id='MySql.Debugger.VisualStudio.2017_Pro' Name='MySql.Debugger.VisualStudio.dll' DiskId='1'
              Source='..\Source\MySql.Debugger.VisualStudio\bin\15.0v4.6.1\release\MySql.Debugger.VisualStudio.dll'/>
        <File Id='MySql.Utility_2017_Pro' Name='MySql.Utility.dll' DiskId='1'
              Source='..\Dependencies\v4.0\release\MySQL.Utility.dll'/>
      </Component>
    </DirectoryRef>

    <DirectoryRef Id='VS15_Pro_TemplatesDir'>
      <Component Id='VS2017_Pro_Templates' Guid='D939AAB9-F888-4EFD-A7C8-F61D4EF593A6'>
        <File Id='VS2017_Pro_MySqlScriptTemplate' Name='MySQL Script.mysql' DiskId='1'
              Source='..\Source\MySql.VisualStudio\Templates\MySQL Script.mysql'/>
        <File Id='VS2017_Pro_ScriptTemplate.vsdir' Name='MySqlDataProviderPackage.vsdir' DiskId='1'
              Source='..\Source\MySql.VisualStudio\Templates\MySqlDataProviderPackage.vsdir'/>
      </Component>
    </DirectoryRef>

    <DirectoryRef Id='VS15_Pro_PrivateAssemblies'>
      <Component Id='VS2017_Pro_MD.Library' Guid='4BAF8A31-DACE-43AD-9EA9-FDE6FC288109'>
        <File Id='VS2017_Pro_MySql.DataLib' Name='MySql.Data.dll' DiskId='1'
             Source='..\Dependencies\v4.0\Release\MySql.Data.dll'/>
      </Component>
      <Component Id='VS2017_Pro_Web.Library' Guid='E94BCEE5-E67F-4B81-A34C-82A7A7EBF055'>
        <File Id='VS2017_Pro_MySql.Web.Lib' Name='MySql.Web.dll' DiskId='1'
             Source='..\Dependencies\v4.0\Release\MySql.Web.dll'/>
      </Component>
      <Component Id='VS2017_Pro_Ext_BouncyCastle.Library' Guid='4A03CA70-5DAB-4DD4-94B1-9EEBEF2EF2E9'>
        <File Id='VS2017_Pro_BouncyCastle.Crypto.Lib' Name='BouncyCastle.Crypto.dll' DiskId='1'
             Source='..\Dependencies\v4.0\Release\BouncyCastle.Crypto.dll'/>
      </Component>
      <Component Id='VS2017_Pro_Ext_SshNet.Library' Guid='941F1C60-6617-43BD-8168-7E5C124673A2'>
        <File Id='VS2017_Pro_Renci.SshNet.Lib' Name='Renci.SshNet.dll' DiskId='1'
             Source='..\Dependencies\v4.0\Release\Renci.SshNet.dll'/>
      </Component>
    </DirectoryRef>

    <!--Item Templates-->
    <DirectoryRef Id='VS15_Pro_ItemTemplates'>
      <Component Id='VS2017_PRO_VSIT_ROOT_DIR' Guid='33FC8416-AF78-4FE5-81AB-034ECB20F113'>
        <File Id='VS2017_Pro_VSCS_ItemTemplate' Name='MySQLforVisualStudio.Item.vstman' DiskId='1'
              Source='..\Installer\ItemTemplates\MySQLforVisualStudio.Item.vstman' />
      </Component>
    </DirectoryRef>

    <DirectoryRef Id='VS15_Pro_CSharpITMySQL'>
      <Component Id='VS2017_PRO_VSIT_DIR' Guid='636E2CE3-AB29-4FDA-84BA-1BB327AC46AD'>
        <File Id='VS2017_Pro_VSCS_Winform_ItemTemplate' Name='CSharpWinform_ItemTemplate.zip' DiskId='1'
              Source='..\ItemTemplatesZipFolder\MySQL_WinForm.zip' />
        <File Id='VS2017_Pro_VSCS_Web_ItemTemplate' Name='CSharpWeb_ItemTemplate.zip' DiskId='1'
              Source='..\ItemTemplatesZipFolder\MySQL_Web.zip' />
      </Component>
    </DirectoryRef>

    <DirectoryRef Id='VS15_Pro_VBITMySQL'>
      <Component Id='VS2017_PRO_VB_VSIT_DIR' Guid='9007C05E-36C3-4D52-AB3A-C6825C04C8B8'>
        <File Id='VS2017_Pro_VSVB_Winform_ItemTemplate' Name='VBWinform_ItemTemplate.zip' DiskId='1'
              Source='..\ItemTemplatesZipFolder\MySQL_VB_WinForm.zip' />
        <File Id='VS2017_Pro_VSVB_Web_ItemTemplate' Name='VBWeb_ItemTemplate.zip' DiskId='1'
              Source='..\ItemTemplatesZipFolder\MySQL_VB_Web.zip' />
      </Component>
    </DirectoryRef>

    <DirectoryRef Id='VS15_Pro_T4TemplatesCSharpDir'>
      <Component Id='VS2017_Pro_T4TemplatesCSharpDir' Guid='C6310DB0-5F48-4DC4-B5AC-D9091D30E01B'>
        <File Id='VS2017_Pro_T4TemplateCSharpController' Name='CSharpControllerClass.tt' DiskId='1'
            Source='..\Source\MySql.VisualStudio\Wizards\Web\T4Templates\CSharp\CSharpControllerClass.tt' />
        <File Id='VS2017_Pro_T4TemplateCSharpIndex' Name='CSharpIndexFile.tt' DiskId='1'
           Source='..\Source\MySql.VisualStudio\Wizards\Web\T4Templates\CSharp\CSharpIndexFile.tt' />
      </Component>
    </DirectoryRef>

    <DirectoryRef Id='VS15_Pro_T4TemplatesVBDir' >
      <Component Id='VS2017_Pro_T4TemplatesVBDir' Guid='C60F1A06-FB5C-45C7-A1E2-AB3C3BA0F8F8'>
        <File Id='VS2017_Pro_T4TemplateVBController' Name='VisualBasicControllerClass.tt' DiskId='1'
            Source='..\Source\MySql.VisualStudio\Wizards\Web\T4Templates\VisualBasic\VisualBasicControllerClass.tt' />
        <File Id='VS2017_Pro_T4TemplateVBIndex' Name='VisualBasicIndexFile.tt' DiskId='1'
           Source='..\Source\MySql.VisualStudio\Wizards\Web\T4Templates\VisualBasic\VisualBasicIndexFile.tt' />
      </Component>
    </DirectoryRef>

    <!--Removing files from Private Assemblies Folders-->
    <DirectoryRef Id='VS11_PrivateAssemblies'>
      <Component Id='Remove.VS2012_MD.Library' Guid='AF082C85-9D64-4B79-8910-C6C25655250A'>
        <RemoveFile Id='RemoveVS2012_MySql.DataLib' Name='MySql.Data.dll' On='uninstall'/>
        <Condition>(NOT UPGRADINGPRODUCTCODE) AND (REMOVE=ALL)</Condition>
      </Component>
      <Component Id='Remove.VS2012_Web.Library' Guid='BA082C85-9D64-4B79-8910-C6C25655251A'>
        <RemoveFile Id='RemoveVS2012_MySql.Web.Lib' Name='MySql.Web.dll' On='uninstall'/>
        <Condition>(NOT UPGRADINGPRODUCTCODE) AND (REMOVE=ALL)</Condition>
      </Component>
      <Component Id="Remove.VS2012_Ext_BouncyCastle.Library" Guid="41E0983E-66F0-4F7E-81D1-D1F0B7D60A2A" DiskId="1">
        <RemoveFile Id="RemoveVS2012_Ext_BouncyCastle.Crypto.Lib" Name="BouncyCastle.Crypto.dll" On="uninstall" />
        <Condition>(NOT UPGRADINGPRODUCTCODE) AND (REMOVE=ALL)</Condition>
      </Component>
      <Component Id="Remove.VS2012_Ext_SshNet.Library" Guid="239DFC00-0C5B-453D-BB48-00C35A3DD215" DiskId="1">
        <RemoveFile Id="RemoveVS2012_Ext_Renci.SshNet.Lib" Name="Renci.SshNet.dll" On="uninstall" />
        <Condition>(NOT UPGRADINGPRODUCTCODE) AND (REMOVE=ALL)</Condition>
      </Component>
    </DirectoryRef>

    <DirectoryRef Id='VS12_PrivateAssemblies'>
      <Component Id="Remove.VS2013_MD.Library" Guid="4D8A38C2-9750-4C35-B89D-FD7FA6789BAA" DiskId="1">
        <RemoveFile Id="RemoveVS2013_MySql.DataLib" Name="MySql.Data.dll" On="uninstall" />
        <Condition>(NOT UPGRADINGPRODUCTCODE) AND (REMOVE=ALL)</Condition>
      </Component>
      <Component Id="Remove.VS2013_Web.Library" Guid="0707943C-D00B-4D81-8722-E10CB4F7755A" DiskId="1">
        <RemoveFile Id="RemoveVS2013_MySql.Web.Lib" Name="MySql.Web.dll" On="uninstall" />
        <Condition>(NOT UPGRADINGPRODUCTCODE) AND (REMOVE=ALL)</Condition>
      </Component>
      <Component Id="Remove.VS2013_Ext_BouncyCastle.Library" Guid="D8D7942B-E0BE-49F8-B35E-82C703F599DF" DiskId="1">
        <RemoveFile Id="RemoveVS2013_Ext_BouncyCastle.Crypto.Lib" Name="BouncyCastle.Crypto.dll" On="uninstall" />
        <Condition>(NOT UPGRADINGPRODUCTCODE) AND (REMOVE=ALL)</Condition>
      </Component>
      <Component Id="Remove.VS2013_Ext_SshNet.Library" Guid="652B1C79-A88E-4074-BA4A-4AAACADE0584" DiskId="1">
        <RemoveFile Id="RemoveVS2013_Ext_Renci.SshNet.Lib" Name="Renci.SshNet.dll" On="uninstall" />
        <Condition>(NOT UPGRADINGPRODUCTCODE) AND (REMOVE=ALL)</Condition>
      </Component>
    </DirectoryRef>

    <DirectoryRef Id='VS14_PrivateAssemblies'>
      <Component Id="Remove.VS2015_MD.Library" Guid="DDF7A0E8-55AD-4379-9B23-7C57078C34A5" DiskId="1">
        <RemoveFile Id="RemoveVS2015_MySql.DataLib" Name="MySql.Data.dll" On="uninstall" />
        <Condition>(NOT UPGRADINGPRODUCTCODE) AND (REMOVE=ALL)</Condition>
      </Component>
      <Component Id="Remove.VS2015_Web.Library" Guid="1DB36478-2940-4202-97FD-BFBC2B2DF8C7" DiskId="1">
        <RemoveFile Id="RemoveVS2015_MySql.Web.Lib" Name="MySql.Web.dll" On="uninstall" />
        <Condition>(NOT UPGRADINGPRODUCTCODE) AND (REMOVE=ALL)</Condition>
      </Component>
      <Component Id="Remove.VS2015_Ext_BouncyCastle.Library" Guid="21FE80EC-6971-4255-ACA0-B45DFBDF0359" DiskId="1">
        <RemoveFile Id="RemoveVS2015_Ext_BouncyCastle.Crypto.Lib" Name="BouncyCastle.Crypto.dll" On="uninstall" />
        <Condition>(NOT UPGRADINGPRODUCTCODE) AND (REMOVE=ALL)</Condition>
      </Component>
      <Component Id="Remove.VS2015_Ext_SshNet.Library" Guid="56E8362F-8E7F-4441-AFB3-A32C8FA1382A" DiskId="1">
        <RemoveFile Id="RemoveVS2015_Ext_Renci.SshNet.Lib" Name="Renci.SshNet.dll" On="uninstall" />
        <Condition>(NOT UPGRADINGPRODUCTCODE) AND (REMOVE=ALL)</Condition>
      </Component>
    </DirectoryRef>

    <!-- Visual Studio 2017 Community -->
    <DirectoryRef Id='VS15_PrivateAssemblies'>
      <Component Id="Remove.VS2017_MD.Library" Guid="8FFC92DF-D7B2-4CCF-AA6D-B0CDD1F6786F" DiskId="1">
        <RemoveFile Id="RemoveVS2017_MySql.DataLib" Name="MySql.Data.dll" On="uninstall" />
        <Condition>(NOT UPGRADINGPRODUCTCODE) AND (REMOVE=ALL)</Condition>
      </Component>
      <Component Id="Remove.VS2017_Web.Library" Guid="7FEAD011-A809-42D8-84A3-7B4DE7F9909A" DiskId="1">
        <RemoveFile Id="RemoveVS2017_MySql.Web.Lib" Name="MySql.Web.dll" On="uninstall" />
        <Condition>(NOT UPGRADINGPRODUCTCODE) AND (REMOVE=ALL)</Condition>
      </Component>
      <Component Id="Remove.VS2017_Ext_BouncyCastle.Library" Guid="82A1F8E2-DEDC-4D72-BB5D-212C80A7DEA6" DiskId="1">
        <RemoveFile Id="RemoveVS2017_Ext_BouncyCastle.Crypto.Lib" Name="BouncyCastle.Crypto.dll" On="uninstall" />
        <Condition>(NOT UPGRADINGPRODUCTCODE) AND (REMOVE=ALL)</Condition>
      </Component>
      <Component Id="Remove.VS2017_Ext_SshNet.Library" Guid="210665AA-4963-4511-AD38-0F63027B89B9" DiskId="1">
        <RemoveFile Id="RemoveVS2017_Ext_Renci.SshNet.Lib" Name="Renci.SshNet.dll" On="uninstall" />
        <Condition>(NOT UPGRADINGPRODUCTCODE) AND (REMOVE=ALL)</Condition>
      </Component>
    </DirectoryRef>

    <!-- Visual Studio 2017 Enterprise -->
    <DirectoryRef Id='VS15_Ent_PrivateAssemblies'>
      <Component Id="Remove.VS2017_Ent_MD.Library" Guid="CC0A4007-C827-4B57-A763-1FF886C59F4E" DiskId="1">
        <RemoveFile Id="RemoveVS2017_Ent_MySql.DataLib" Name="MySql.Data.dll" On="uninstall" />
        <Condition>(NOT UPGRADINGPRODUCTCODE) AND (REMOVE=ALL)</Condition>
      </Component>
      <Component Id="Remove.VS2017_Ent_Web.Library" Guid="1F36C4A0-C4A4-461A-90AC-9625DA47B51D" DiskId="1">
        <RemoveFile Id="RemoveVS2017_Ent_MySql.Web.Lib" Name="MySql.Web.dll" On="uninstall" />
        <Condition>(NOT UPGRADINGPRODUCTCODE) AND (REMOVE=ALL)</Condition>
      </Component>
      <Component Id="Remove.VS2017_Ent_Ext_BouncyCastle.Library" Guid="8ED78EBB-212C-48C0-8EAA-A4EF019F7A27" DiskId="1">
        <RemoveFile Id="RemoveVS2017_Ent_Ext_BouncyCastle.Crypto.Lib" Name="BouncyCastle.Crypto.dll" On="uninstall" />
        <Condition>(NOT UPGRADINGPRODUCTCODE) AND (REMOVE=ALL)</Condition>
      </Component>
      <Component Id="Remove.VS2017_Ent_Ext_SshNet.Library" Guid="3D8934C1-8EE6-4536-8752-AF4663759845" DiskId="1">
        <RemoveFile Id="RemoveVS2017_Ent_Ext_Renci.SshNet.Lib" Name="Renci.SshNet.dll" On="uninstall" />
        <Condition>(NOT UPGRADINGPRODUCTCODE) AND (REMOVE=ALL)</Condition>
      </Component>
    </DirectoryRef>

    <!-- Visual Studio 2017 Professional -->
    <DirectoryRef Id='VS15_Pro_PrivateAssemblies'>
      <Component Id="Remove.VS2017_Pro_MD.Library" Guid="DCF9242B-D29A-42A0-B274-642245C2D824" DiskId="1">
        <RemoveFile Id="RemoveVS2017_Pro_MySql.DataLib" Name="MySql.Data.dll" On="uninstall" />
        <Condition>(NOT UPGRADINGPRODUCTCODE) AND (REMOVE=ALL)</Condition>
      </Component>
      <Component Id="Remove.VS2017_Pro_Web.Library" Guid="74EACE76-6414-432D-8937-04278E364DF5" DiskId="1">
        <RemoveFile Id="RemoveVS2017_Pro_MySql.Web.Lib" Name="MySql.Web.dll" On="uninstall" />
        <Condition>(NOT UPGRADINGPRODUCTCODE) AND (REMOVE=ALL)</Condition>
      </Component>
      <Component Id="Remove.VS2017_Pro_Ext_BouncyCastle.Library" Guid="9747BBAD-1083-4BA0-9FE0-312C17DFFBFB" DiskId="1">
        <RemoveFile Id="RemoveVS2017_Pro_Ext_BouncyCastle.Crypto.Lib" Name="BouncyCastle.Crypto.dll" On="uninstall" />
        <Condition>(NOT UPGRADINGPRODUCTCODE) AND (REMOVE=ALL)</Condition>
      </Component>
      <Component Id="Remove.VS2017_Pro_Ext_SshNet.Library" Guid="0F91C8F7-60AE-4B6A-AA0F-0AA28761E9C3" DiskId="1">
        <RemoveFile Id="RemoveVS2017_Pro_Ext_Renci.SshNet.Lib" Name="Renci.SshNet.dll" On="uninstall" />
        <Condition>(NOT UPGRADINGPRODUCTCODE) AND (REMOVE=ALL)</Condition>
      </Component>
    </DirectoryRef>

    <Feature Id='VS2012Int' Level='1' Title='Visual Studio 2012'>
      <Condition Level='0'>Not VS_2012_PATH AND Not Installed</Condition>
      <ComponentRef Id='VS2012_Extension'/>
      <ComponentRef Id='VS2012_Templates'/>
      <ComponentRef Id='VS2012_MD.Library' />
      <ComponentRef Id='VS2012_Web.Library' />
      <ComponentRef Id='VS2012_Ext_BouncyCastle.Library' />
      <ComponentRef Id='VS2012_Ext_SshNet.Library' />
      <ComponentRef Id='Remove.VS2012_MD.Library'/>
      <ComponentRef Id='Remove.VS2012_Web.Library'/>
      <ComponentRef Id='Remove.VS2012_Ext_BouncyCastle.Library'/>
      <ComponentRef Id='Remove.VS2012_Ext_SshNet.Library'/>
      <ComponentRef Id='AutoLoadPackageVS2012'/>
      <!--Item Templates-->
      <Feature Id='VS2012_AddItemTemplate' Title='ItemTemplates' Level='1' Display='hidden'>
        <ComponentRef Id='VS2012_VSIT_DIR'/>
        <ComponentGroupRef Id='VS11_CS_WinForm_ItemTemplate_DirectoryComponents'/>
        <ComponentGroupRef Id='VS11_CS_Web_ItemTemplate_DirectoryComponents'/>
        <ComponentRef Id='VS2012_VB_VSIT_DIR'/>
        <ComponentGroupRef Id='VS11_VB_WinForm_ItemTemplate_DirectoryComponents'/>
        <ComponentGroupRef Id='VS11_VB_Web_ItemTemplate_DirectoryComponents'/>
        <ComponentRef Id='VS2012_T4TemplatesCSharpDir' />
        <ComponentRef Id='VS2012_T4TemplatesVBDir' />
      </Feature>
    </Feature>

    <Feature Id='VS2013Int' Level='1' Title='Visual Studio 2013'>
      <Condition Level='0'>Not VS_2013_PATH AND Not Installed</Condition>
      <ComponentRef Id='VS2013_Extension'/>
      <ComponentRef Id='VS2013_Templates'/>
      <ComponentRef Id='VS2013_MD.Library' />
      <ComponentRef Id='VS2013_Web.Library' />
      <ComponentRef Id='VS2013_Ext_BouncyCastle.Library' />
      <ComponentRef Id='VS2013_Ext_SshNet.Library' />
      <ComponentRef Id='Remove.VS2013_MD.Library'/>
      <ComponentRef Id='Remove.VS2013_Web.Library'/>
      <ComponentRef Id='Remove.VS2013_Ext_BouncyCastle.Library'/>
      <ComponentRef Id='Remove.VS2013_Ext_SshNet.Library'/>
      <ComponentRef Id='AutoLoadPackageVS2013'/>
      <!--Item Templates-->
      <Feature Id='VS2013_AddItemTemplate' Title='ItemTemplates' Level='1' Display='hidden'>
        <ComponentRef Id='VS2013_VSIT_DIR'/>
        <ComponentGroupRef Id='VS12_CS_WinForm_ItemTemplate_DirectoryComponents'/>
        <ComponentGroupRef Id='VS12_CS_Web_ItemTemplate_DirectoryComponents'/>
        <ComponentRef Id='VS2013_VB_VSIT_DIR'/>
        <ComponentGroupRef Id='VS12_VB_WinForm_ItemTemplate_DirectoryComponents'/>
        <ComponentGroupRef Id='VS12_VB_Web_ItemTemplate_DirectoryComponents'/>
        <ComponentRef Id='VS2013_T4TemplatesCSharpDir' />
        <ComponentRef Id='VS2013_T4TemplatesVBDir' />
      </Feature>
    </Feature>

    <Feature Id='VS2015Int' Level='1' Title='Visual Studio 2015'>
      <Condition Level='0'>Not VS_2015_PATH AND Not Installed</Condition>
      <ComponentRef Id='VS2015_Extension'/>
      <ComponentRef Id='VS2015_Templates'/>
      <ComponentRef Id='VS2015_MD.Library' />
      <ComponentRef Id='VS2015_Web.Library' />
      <ComponentRef Id='VS2015_Ext_BouncyCastle.Library' />
      <ComponentRef Id='VS2015_Ext_SshNet.Library' />
      <ComponentRef Id='Remove.VS2015_MD.Library'/>
      <ComponentRef Id='Remove.VS2015_Web.Library'/>
      <ComponentRef Id='Remove.VS2015_Ext_BouncyCastle.Library'/>
      <ComponentRef Id='Remove.VS2015_Ext_SshNet.Library'/>
      <ComponentRef Id='AutoLoadPackageVS2015'/>
      <!--Item Templates-->
      <Feature Id='VS2015_AddItemTemplate' Title='ItemTemplates' Level='1' Display='hidden' >
        <ComponentRef Id='VS2015_VSIT_DIR'/>
        <ComponentGroupRef Id='VS14_CS_WinForm_ItemTemplate_DirectoryComponents'/>
        <ComponentGroupRef Id='VS14_CS_Web_ItemTemplate_DirectoryComponents'/>
        <ComponentRef Id='VS2015_VB_VSIT_DIR'/>
        <ComponentGroupRef Id='VS14_VB_WinForm_ItemTemplate_DirectoryComponents'/>
        <ComponentGroupRef Id='VS14_VB_Web_ItemTemplate_DirectoryComponents'/>
        <ComponentRef Id='VS2015_T4TemplatesCSharpDir' />
        <ComponentRef Id='VS2015_T4TemplatesVBDir' />
      </Feature>
    </Feature>

    <Feature Id='VS2017Int' Level='1' Title='Visual Studio 2017' Display='expand'>
      <Condition Level='0'>(Not VS_2017_COM_PATH AND Not VS_2017_ENT_PATH AND Not VS_2017_PRO_PATH) AND Not Installed</Condition>
      <Feature Id='VS2017CommunityInt' Level='1' Title='Visual Studio 2017 Community'>
        <Condition Level='0'>Not VS_2017_COM_PATH AND Not Installed</Condition>
        <ComponentRef Id='VS2017_Extension'/>
        <ComponentRef Id='VS2017_Templates'/>
        <ComponentRef Id='VS2017_MD.Library' />
        <ComponentRef Id='VS2017_Web.Library' />
        <ComponentRef Id='VS2017_Ext_BouncyCastle.Library' />
        <ComponentRef Id='VS2017_Ext_SshNet.Library' />
        <ComponentRef Id='Remove.VS2017_MD.Library'/>
        <ComponentRef Id='Remove.VS2017_Web.Library'/>
        <ComponentRef Id='Remove.VS2017_Ext_BouncyCastle.Library'/>
        <ComponentRef Id='Remove.VS2017_Ext_SshNet.Library'/>
        <ComponentRef Id='VS2017_Com_EVars'/>
        <!--Item Templates-->
        <Feature Id='VS2017_AddItemTemplate' Title='ItemTemplates' Level='1'>
          <ComponentRef Id='VS2017_VSIT_ROOT_DIR'/>
          <ComponentRef Id='VS2017_VSIT_DIR'/>
          <ComponentGroupRef Id='VS15_CS_WinForm_ItemTemplate_DirectoryComponents'/>
          <ComponentGroupRef Id='VS15_CS_Web_ItemTemplate_DirectoryComponents'/>
          <ComponentRef Id='VS2017_VB_VSIT_DIR'/>
          <ComponentGroupRef Id='VS15_VB_WinForm_ItemTemplate_DirectoryComponents'/>
          <ComponentGroupRef Id='VS15_VB_Web_ItemTemplate_DirectoryComponents'/>
          <ComponentRef Id='VS2017_T4TemplatesCSharpDir' />
          <ComponentRef Id='VS2017_T4TemplatesVBDir' />
        </Feature>
      </Feature>
      <Feature Id='VS2017EnterpriseInt' Level='1' Title='Visual Studio 2017 Enterprise'>
        <Condition Level='0'>Not VS_2017_ENT_PATH AND Not Installed</Condition>
        <ComponentRef Id='VS2017_Ent_Extension'/>
        <ComponentRef Id='VS2017_Ent_Templates'/>
        <ComponentRef Id='VS2017_Ent_MD.Library' />
        <ComponentRef Id='VS2017_Ent_Web.Library' />
        <ComponentRef Id='VS2017_Ent_Ext_BouncyCastle.Library' />
        <ComponentRef Id='VS2017_Ent_Ext_SshNet.Library' />
        <ComponentRef Id='Remove.VS2017_Ent_MD.Library'/>
        <ComponentRef Id='Remove.VS2017_Ent_Web.Library'/>
        <ComponentRef Id='Remove.VS2017_Ent_Ext_BouncyCastle.Library'/>
        <ComponentRef Id='Remove.VS2017_Ent_Ext_SshNet.Library'/>
        <ComponentRef Id='VS2017_Ent_EVars'/>
        <!--Item Templates-->
        <Feature Id='VS2017_Ent_AddItemTemplate' Title='ItemTemplates' Level='1'>
          <ComponentRef Id='VS2017_ENT_VSIT_ROOT_DIR'/>
          <ComponentRef Id='VS2017_ENT_VSIT_DIR'/>
          <ComponentGroupRef Id='VS15_Ent_CS_WinForm_ItemTemplate_DirectoryComponents'/>
          <ComponentGroupRef Id='VS15_Ent_CS_Web_ItemTemplate_DirectoryComponents'/>
          <ComponentRef Id='VS2017_ENT_VB_VSIT_DIR'/>
          <ComponentGroupRef Id='VS15_Ent_VB_WinForm_ItemTemplate_DirectoryComponents'/>
          <ComponentGroupRef Id='VS15_Ent_VB_Web_ItemTemplate_DirectoryComponents'/>
          <ComponentRef Id='VS2017_Ent_T4TemplatesCSharpDir' />
          <ComponentRef Id='VS2017_Ent_T4TemplatesVBDir' />
        </Feature>
      </Feature>
      <Feature Id='VS2017ProfessionalInt' Level='1' Title='Visual Studio 2017 Professional'>
        <Condition Level='0'>Not VS_2017_PRO_PATH AND Not Installed</Condition>
        <ComponentRef Id='VS2017_Pro_Extension'/>
        <ComponentRef Id='VS2017_Pro_Templates'/>
        <ComponentRef Id='VS2017_Pro_MD.Library' />
        <ComponentRef Id='VS2017_Pro_Web.Library' />
        <ComponentRef Id='VS2017_Pro_Ext_BouncyCastle.Library' />
        <ComponentRef Id='VS2017_Pro_Ext_SshNet.Library' />
        <ComponentRef Id='Remove.VS2017_Pro_MD.Library'/>
        <ComponentRef Id='Remove.VS2017_Pro_Web.Library'/>
        <ComponentRef Id='Remove.VS2017_Pro_Ext_BouncyCastle.Library'/>
        <ComponentRef Id='Remove.VS2017_Pro_Ext_SshNet.Library'/>
        <ComponentRef Id='VS2017_Pro_EVars'/>
        <!--Item Templates-->
        <Feature Id='VS2017_Pro_AddItemTemplate' Title='ItemTemplates' Level='1'>
          <ComponentRef Id='VS2017_PRO_VSIT_ROOT_DIR'/>
          <ComponentRef Id='VS2017_PRO_VSIT_DIR'/>
          <ComponentGroupRef Id='VS15_Pro_CS_WinForm_ItemTemplate_DirectoryComponents'/>
          <ComponentGroupRef Id='VS15_Pro_CS_Web_ItemTemplate_DirectoryComponents'/>
          <ComponentRef Id='VS2017_PRO_VB_VSIT_DIR'/>
          <ComponentGroupRef Id='VS15_Pro_VB_WinForm_ItemTemplate_DirectoryComponents'/>
          <ComponentGroupRef Id='VS15_Pro_VB_Web_ItemTemplate_DirectoryComponents'/>
          <ComponentRef Id='VS2017_Pro_T4TemplatesCSharpDir' />
          <ComponentRef Id='VS2017_Pro_T4TemplatesVBDir' />
        </Feature>
      </Feature>
    </Feature>

    <!-- Visual Studio 2012 installation location -->
    <Property Id='VS_2012_PATH' Secure='yes'>
      <RegistrySearch Id='Find_VS2012_Path' Win64='no' Root='HKLM' Key='SOFTWARE\Microsoft\VisualStudio\11.0\Setup\VS'
          Name='EnvironmentDirectory' Type='raw'/>
    </Property>

    <!-- Visual Studio 2013 installation location -->
    <!-- way to get VS2013 is clumsy due to Wix not currently having VS2013 support -->
    <Property Id='VS_2013_PATH' Secure='yes'>
      <RegistrySearch Id='Find_VS2013_Path' Win64='no' Root='HKLM' Key='SOFTWARE\Microsoft\VisualStudio\12.0\'
          Name='ShellFolder' Type='raw'/>
    </Property>

    <!-- Visual Studio 2015 installation location -->
    <Property Id='VS_2015_PATH' Secure='yes'>
      <RegistrySearch Id='Find_VS2015_Path' Win64='no' Root='HKLM' Key='SOFTWARE\Microsoft\VisualStudio\14.0\'
          Name='ShellFolder' Type='raw'/>
    </Property>

    <!-- Visual Studio 2017 installation locations -->
    <!-- Value is calculated at runtime using the Setup Configuration API. -->
    <Property Id='VS_2017_COM_PATH' Secure='yes' />
    <Property Id='VS_2017_ENT_PATH' Secure='yes' />
    <Property Id='VS_2017_PRO_PATH' Secure='yes' />

    <!-- Additional properties -->
    <Property Id='CNETVERSION' Secure='yes' />
    <Property Id='VS2015INSTALL' Secure='yes' />
    <Property Id='VS2017COMINSTALL' Secure='yes' />
    <Property Id='VS2017ENTINSTALL' Secure='yes' />
    <Property Id='VS2017PROINSTALL' Secure='yes' />

    <!-- Visual Studio 2012 Custom Action (update packages file) -->
    <Binary Id="VS11_PackagesFile" SourceFile="..\MySql.VisualStudio.CustomAction\bin\Release\MySql.VisualStudio.CustomAction.CA.dll" />
    <CustomAction Id="VS2012_SetPathProp" Property="VS11_UpdatePackageFile" Value="VS2012_PathProp=[VS_2012_PATH]" Return="check" />
    <CustomAction Id="VS11_UpdatePackageFile" DllEntry="UpdateFlagPackagesFileForVs2012" BinaryKey="VS11_PackagesFile" Execute="deferred" Return="check" Impersonate="no" />

    <!-- Visual Studio 2013 Custom Action (update packages file) -->
    <Binary Id="VS12_PackagesFile" SourceFile="..\MySql.VisualStudio.CustomAction\bin\Release\MySql.VisualStudio.CustomAction.CA.dll" />
    <CustomAction Id="VS2013_SetPathProp" Property="VS12_UpdatePackageFile" Value="VS2013_PathProp=[VS_2013_PATH]" Return="check" />
    <CustomAction Id="VS12_UpdatePackageFile" DllEntry="UpdateFlagPackagesFileForVs2013" BinaryKey="VS12_PackagesFile" Execute="deferred" Return="check" Impersonate="no" />

    <!-- Visual Studio 2015 Custom Action (update packages file) -->
    <Binary Id="VS14_PackagesFile" SourceFile="..\MySql.VisualStudio.CustomAction\bin\Release\MySql.VisualStudio.CustomAction.CA.dll" />
    <CustomAction Id="VS2015_SetPathProp" Property="VS14_UpdatePackageFile" Value="VS2015_PathProp=[VS_2015_PATH]" Return="check" />
    <CustomAction Id="VS14_UpdatePackageFile" DllEntry="UpdateFlagPackagesFileForVs2015" BinaryKey="VS14_PackagesFile" Execute="deferred" Return="check" Impersonate="no" />

    <!-- Visual Studio 2017 Community Custom Action (update packages file) -->
    <Binary Id="VS15_PackagesFile" SourceFile="..\MySql.VisualStudio.CustomAction\bin\Release\MySql.VisualStudio.CustomAction.CA.dll" />
    <CustomAction Id="VS2017_SetPathProp" Property="VS15_UpdatePackageFile" Value="VS2017_PathProp=[VS_2017_COM_PATH]" Return="check" />
    <CustomAction Id="VS15_UpdatePackageFile" DllEntry="UpdateFlagPackagesFileForVs2017" BinaryKey="VS15_PackagesFile" Execute="deferred" Return="check" Impersonate="no" />

    <!-- Visual Studio 2017 Community Custom Action -->
    <SetProperty Id="VS15Setup_Custom" Value="&quot;[VS15.IDEFolder]devenv&quot; /updateconfiguration /log" Before="VS15Setup_Custom" Sequence="execute" />
    <CustomAction Id="VS15Setup_Custom" BinaryKey="WixCA" DllEntry="WixQuietExec" Execute="deferred" Return="ignore" Impersonate="no" />

    <!-- Visual Studio 2017 Enterprise Custom Action (update packages file) -->
    <Binary Id="VS15Ent_PackFile" SourceFile="..\MySql.VisualStudio.CustomAction\bin\Release\MySql.VisualStudio.CustomAction.CA.dll" />
    <CustomAction Id="VS2017_Ent_SetPathProp" Property="VS15_Ent_UpdatePackageFile" Value="VS2017_Ent_PathProp=[VS_2017_ENT_PATH]" Return="check" />
    <CustomAction Id="VS15_Ent_UpdatePackageFile" DllEntry="UpdateFlagPackagesFileForVs2017Enterprise" BinaryKey="VS15Ent_PackFile" Execute="deferred" Return="check" Impersonate="no" />

    <!-- Visual Studio 2017 Enterprise Custom Action -->
    <SetProperty Id="VS15_Ent_Setup_Custom" Value="&quot;[VS15.Ent.IDEFolder]devenv&quot; /updateconfiguration /log" Before="VS15_Ent_Setup_Custom" Sequence="execute" />
    <CustomAction Id="VS15_Ent_Setup_Custom" BinaryKey="WixCA" DllEntry="WixQuietExec" Execute="deferred" Return="ignore" Impersonate="no" />

    <!-- Visual Studio 2017 Professional Custom Action (update packages file) -->
    <Binary Id="VS15Pro_PackFile" SourceFile="..\MySql.VisualStudio.CustomAction\bin\Release\MySql.VisualStudio.CustomAction.CA.dll" />
    <CustomAction Id="VS2017_Pro_SetPathProp" Property="VS15_Pro_UpdatePackageFile" Value="VS2017_Pro_PathProp=[VS_2017_PRO_PATH]" Return="check" />
    <CustomAction Id="VS15_Pro_UpdatePackageFile" DllEntry="UpdateFlagPackagesFileForVs2017Professional" BinaryKey="VS15Pro_PackFile" Execute="deferred" Return="check" Impersonate="no" />

    <!-- Visual Studio 2017 Professional Custom Action -->
    <SetProperty Id="VS15_Pro_Setup_Custom" Value="&quot;[VS15.Pro.IDEFolder]devenv&quot; /updateconfiguration /log" Before="VS15_Pro_Setup_Custom" Sequence="execute" />
    <CustomAction Id="VS15_Pro_Setup_Custom" BinaryKey="WixCA" DllEntry="WixQuietExec" Execute="deferred" Return="ignore" Impersonate="no" />

    <!-- Custom Action for updating the pkdef file -->
    <Binary Id="AfterInstallActions" SourceFile="..\MySql.VisualStudio.CustomAction\bin\Release\MySql.VisualStudio.CustomAction.CA.dll" />
    <CustomAction Id="UpdatePkgdefFileParameters" Property="UpdatePkgdefFile" Value="MySqlForVisualStudioVersion=$(var.Version);ConnectorVersion=[CNETVERSION];VS2015Path=[VS_2015_PATH];VS2017ComPath=[VS_2017_COM_PATH];VS2017EntPath=[VS_2017_ENT_PATH];VS2017ProPath=[VS_2017_PRO_PATH];VS2015Install=[VS2015INSTALL];VS2017ComInstall=[VS2017COMINSTALL];VS2017EntInstall=[VS2017ENTINSTALL];VS2017ProInstall=[VS2017PROINSTALL]" Return="check" />
    <CustomAction Id="UpdatePkgdefFile" DllEntry="AddRedirectEntries" BinaryKey="AfterInstallActions" Execute="deferred" Return="check" Impersonate="no" />

    <!-- Show warning message for Windows 7 users -->
    <Binary Id="Win7Installation" SourceFile="..\MySql.VisualStudio.CustomAction\bin\Release\MySql.VisualStudio.CustomAction.CA.dll" />
    <CustomAction Id="Win7_ShowWarning" DllEntry="ShowInstallationWarning" BinaryKey="Win7Installation" Execute="immediate" Return="ignore" Impersonate="no" />

    <!-- Adding AutoLoadPackage option so our connections are available -->
    <DirectoryRef Id="INSTALLDIR">
      <Component Id="AutoLoadPackageVS2012" Guid="*">
        <RegistryKey Root="HKLM"
                     Key="SOFTWARE\Microsoft\VisualStudio\11.0\AutoLoadPackages\{adfc4e64-0397-11d1-9f4e-00a0c911004f}"
                     ForceCreateOnInstall="yes"
                     ForceDeleteOnUninstall="yes">
          <RegistryValue Type="integer" Name="{79a115c9-b133-4891-9e7b-242509dad272}"  Value="0" />
        </RegistryKey>
      </Component>
    </DirectoryRef>

    <DirectoryRef Id="INSTALLDIR">
      <Component Id="AutoLoadPackageVS2013" Guid="*">
        <RegistryKey Root="HKLM"
                     Key="SOFTWARE\Microsoft\VisualStudio\12.0\AutoLoadPackages\{adfc4e64-0397-11d1-9f4e-00a0c911004f}"
                     ForceCreateOnInstall="yes"
                     ForceDeleteOnUninstall="yes">
          <RegistryValue Type="integer" Name="{79a115c9-b133-4891-9e7b-242509dad272}"  Value="0" />
        </RegistryKey>
      </Component>
    </DirectoryRef>

    <DirectoryRef Id="INSTALLDIR">
      <Component Id="AutoLoadPackageVS2015" Guid="*">
        <RegistryKey Root="HKLM"
                     Key="SOFTWARE\Microsoft\VisualStudio\14.0\AutoLoadPackages\{adfc4e64-0397-11d1-9f4e-00a0c911004f}"
                     ForceCreateOnInstall="yes"
                     ForceDeleteOnUninstall="yes">
          <RegistryValue Type="integer" Name="{79a115c9-b133-4891-9e7b-242509dad272}"  Value="0" />
        </RegistryKey>
      </Component>
    </DirectoryRef>

    <InstallExecuteSequence>
      <Custom Action="VS15_SetInstallationPaths" Before="LaunchConditions"></Custom>
      <Custom Action='VS2012_SetPathProp' Before='InstallFinalize'>(&amp;VS2012Int=2) OR (&amp;VS2012Int=3)</Custom>
      <Custom Action='VS2013_SetPathProp' After='VS2012_SetPathProp'>(&amp;VS2013Int=2) OR (&amp;VS2013Int=3)</Custom>
      <Custom Action='VS2015_SetPathProp' After='VS2013_SetPathProp'>(&amp;VS2015Int=2) OR (&amp;VS2015Int=3)</Custom>
      <Custom Action="VS11_UpdatePackageFile" After='VS2015_SetPathProp'>(&amp;VS2012Int=2) OR (&amp;VS2012Int=3)</Custom>
      <Custom Action="VS12_UpdatePackageFile" After='VS11_UpdatePackageFile'>(&amp;VS2013Int=2) OR (&amp;VS2013Int=3)</Custom>
      <Custom Action="VS14_UpdatePackageFile" After='VS12_UpdatePackageFile'>(&amp;VS2015Int=2) OR (&amp;VS2015Int=3)</Custom>
      <Custom Action='UpdatePkgdefFileParameters' After='VS14_UpdatePackageFile'>CNETINSTALLED = "Yes" AND ((&amp;VS2015Int=2) OR (&amp;VS2015Int=3) OR (&amp;VS2017CommunityInt=2) OR (&amp;VS2017CommunityInt=3) OR (&amp;VS2017EnterpriseInt=2) OR (&amp;VS2017EnterpriseInt=3) OR (&amp;VS2017ProfessionalInt=2) OR (&amp;VS2017ProfessionalInt=3))</Custom>
      <Custom Action='UpdatePkgdefFile' After='UpdatePkgdefFileParameters'>CNETINSTALLED = "Yes" AND ((&amp;VS2015Int=2) OR (&amp;VS2015Int=3) OR (&amp;VS2017CommunityInt=2) OR (&amp;VS2017CommunityInt=3) OR (&amp;VS2017EnterpriseInt=2) OR (&amp;VS2017EnterpriseInt=3) OR (&amp;VS2017ProfessionalInt=2) OR (&amp;VS2017ProfessionalInt=3))</Custom>
      <Custom Action='VS2012Setup' After='UpdatePkgdefFile'>(&amp;VS2012Int=2) OR (&amp;VS2012Int=3)</Custom>
      <Custom Action='VS2013Setup' After='VS2012Setup'>(&amp;VS2013Int=2) OR (&amp;VS2013Int=3)</Custom>
      <Custom Action='VS2015Setup' After='VS2013Setup'>(&amp;VS2015Int=2) OR (&amp;VS2015Int=3)</Custom>
      <Custom Action='VS15Setup_Custom' After='VS2015Setup'>(&amp;VS2017CommunityInt=2) OR (&amp;VS2017CommunityInt=3)</Custom>
      <Custom Action='VS15_Ent_Setup_Custom' After='VS15Setup_Custom'>(&amp;VS2017EnterpriseInt=2) OR (&amp;VS2017EnterpriseInt=3)</Custom>
      <Custom Action='VS15_Pro_Setup_Custom' After='VS15_Ent_Setup_Custom'>(&amp;VS2017ProfessionalInt=2) OR (&amp;VS2017ProfessionalInt=3)</Custom>
      <Custom Action="Win7_ShowWarning" After="InstallFinalize"><![CDATA[VersionNT = 601]]></Custom>
    </InstallExecuteSequence>
  </Fragment>
</Wix>


